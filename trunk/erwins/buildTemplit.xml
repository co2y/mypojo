<?xml version="1.0" encoding="UTF-8"?>
<project name="templit" >
	
	<!-- 대부분 공통으로 사용되는 default를 정의해준다. -->
	<property name="default.dir" value="WebContent/WEB-INF/lib" />
	<property name="default.classes" value="WebContent/WEB-INF/classes" />
	<tstamp description="백업스탬프 등에 사용"><format property="sysDate" pattern="yyyy-MM-dd-[HH-mm]"/></tstamp>
	
	<!-- ================================================================================================== -->
	<!-- target 시작 -->
	<!-- ================================================================================================== -->		
	
	<property name="temp.dir" location="/antTemp" description="OS의 기본 경로이다. 종료후 삭제된다." />
	
	<macrodef name="changeJar" description="jar를 만든 후 overwrite한다. ">
			<attribute name="name"/>
			<attribute name="classPath"/>
			<attribute name="pakage"/>
			<attribute name="toDir"/>
		<sequential>
			<mkdir dir="${temp.dir}"/>
			<jar destfile="${temp.dir}/@{name}.jar" basedir="@{classPath}">
				<include name="@{pakage}/**/*.class"/>
			</jar>
			<copy todir="@{toDir}" overwrite="yes">
			     <fileset dir="${temp.dir}" >
			        <include name="**/*/*.jar" />
			        <include name="*.jar" />
			      </fileset>
			</copy>
			<delete dir="${temp.dir}"/>
		</sequential>
	</macrodef>
	
	<macrodef name="signedApplet" description="Applet Signed Jar 파일을 생성합니다.">
			<attribute name="jarName"/>
			<attribute name="classPath"/>
			<attribute name="include"/>
			<attribute name="toDir"/>
		<sequential>
			<mkdir dir="${temp.dir}"/>
			<jar destfile="${temp.dir}/@{jarName}.jar" basedir="@{classPath}">
				<include name="@{include}"/>
			</jar>
			<exec dir="${temp.dir}" executable="keytool">
				<arg value="-genkey" />
				<arg value="-alias" />
				<arg value="ErwinsApplet" />
				<arg value="-keystore" />
				<arg value="ErwinsAppletKeyStore" />
				<arg value="-keypass" />
				<arg value="qwer1234" />
				<arg value="-storepass" />
				<arg value="qwer1234" />
				<arg value="-dname" />
				<arg value="cn=Sin Sng Han, o=erwins.com, l=Inchon, s=Jeolla, C=Korea" />
			</exec>
					
			<exec dir="${temp.dir}" executable="keytool">
				<arg value="-selfcert" />
				<arg value="-alias" />
				<arg value="ErwinsApplet" />
				<arg value="-keystore" />
				<arg value="ErwinsAppletKeyStore" />
				<arg value="-keypass" />
				<arg value="qwer1234" />
				<arg value="-storepass" />
				<arg value="qwer1234" />
				<arg value="-dname" />
				<arg value="cn=Sin Sng Han, o=erwins.com, l=Inchon, s=Jeolla, C=Korea" />
			</exec>		
					
			<mkdir dir="@{toDir}"/>
			
			<signjar signedjar="@{toDir}/@{jarName}.jar"  jar="${temp.dir}/@{jarName}.jar" alias="@{jarName}" 
				keystore="${temp.dir}/ErwinsAppletKeyStore" storepass="qwer1234"></signjar>
			
			<delete dir="${temp.dir}"/>
		</sequential>
	</macrodef>	
	
	<!-- ================================================================================================== -->
	<!-- 인증 applet 작성  -->
	<!-- ================================================================================================== -->
	<!--
	<target name="applet" description="Applet Signed Jar 파일을 생성합니다.">
		<jar destfile="${pc.dir.root}/${myPage.name}/WebContent/ErwinsApplet.jar">
			<fileset dir="${pc.dir.root}/${myPage.name}/${templit.classes}">
				<include name="erwins/util/file/AppletUploader*.class" />
			</fileset>
		</jar>
		
		<exec dir="${pc.dir.root}/${myPage.name}/WebContent" executable="keytool">
			<arg value="-genkey" />
			<arg value="-alias" />
			<arg value="ErwinsApplet" />
			<arg value="-keystore" />
			<arg value="ErwinsAppletKeyStore" />
			<arg value="-keypass" />
			<arg value="qwer1234" />
			<arg value="-storepass" />
			<arg value="qwer1234" />
			<arg value="-dname" />
			<arg value="cn=Sin Sng Han, o=erwins.com, l=Inchon, s=Jeolla, C=Korea" />
		</exec>
		
		<exec dir="${pc.dir.root}/${myPage.name}/WebContent" executable="keytool">
			<arg value="-selfcert" />
			<arg value="-alias" />
			<arg value="ErwinsApplet" />
			<arg value="-keystore" />
			<arg value="ErwinsAppletKeyStore" />
			<arg value="-keypass" />
			<arg value="qwer1234" />
			<arg value="-storepass" />
			<arg value="qwer1234" />
			<arg value="-dname" />
			<arg value="cn=Sin Sng Han, o=erwins.com, l=Inchon, s=Jeolla, C=Korea" />
		</exec>		
		
		<mkdir dir="${pc.dir.root}/${myPage.name}/WebContent/framework/applet"/>
		<signjar signedjar="${pc.dir.root}/${myPage.name}/WebContent/framework/applet/ErwinsApplet.jar" 
			jar="${pc.dir.root}/${myPage.name}/WebContent/ErwinsApplet.jar" alias="ErwinsApplet" 
			keystore="${pc.dir.root}/${myPage.name}/WebContent/ErwinsAppletKeyStore" storepass="qwer1234"></signjar>
		<delete file="${pc.dir.root}/${myPage.name}/WebContent/ErwinsApplet.jar"/> 
		<delete file="${pc.dir.root}/${myPage.name}/WebContent/ErwinsAppletKeyStore"/>
	</target>  -->
	
	<path id="classpath2">
	          <fileset dir="D:\PROJECT\workspace\erwins\WebContent\WEB-INF\lib" includes="*.jar"/>
	    	  <fileset dir="D:\PROJECT\workspace\_jar\java" includes="servlet-api.jar,jsp-api.jar"/>
	</path>	
	
    <target name="javadoc" description="자바독을 생성하고 압축합니다. 중간에 멈춤.">
        <javadoc access="private"   locale="ko_KR" encoding="UTF-8" docencoding="UTF-8" charset="UTF-8"
        	author="true"  classpathref="classpath2"
        	destdir="D:\PROJECT\workspace\erwins\doc" doctitle="erwinsDoc" nodeprecated="false" 
        	nodeprecatedlist="false" noindex="false" nonavbar="false" notree="false" 
        	packagenames="erwins.util.**" source="1.5" sourcepath="D:\PROJECT\workspace\erwins\src" 
        	splitindex="true" use="true" version="true"/>
    	<zip destfile="D:\PROJECT\workspace\erwins\doc\erwinsDoc.zip" compress="true" >
			<fileset dir="D:\PROJECT\workspace\erwins\doc"/>
		</zip>
    </target>
	
    <target name="jj" description="JUnit..">
		<junit haltonfailure="true" printsummary="true" >
			<classpath refid="classAll"/>
			<formatter type="brief" usefile="false" />
			<test name="erwins.myPage.test4._SimpleTest"/>
		</junit>
    </target>
	
	<path id="classAll">
	          <fileset dir="D:\PROJECT\workspace\erwins\WebContent\WEB-INF\lib" includes="*.jar"/>
	    	  <fileset dir="D:\PROJECT\workspace\_jar\java" includes="servlet-api.jar,jsp-api.jar"/>
			<fileset dir="D:\PROJECT\workspace\erwins\WebContent\WEB-INF\classes" includes="*.class" />
			<fileset dir="C:\Program Files\Java\jdk1.6.0_03\lib" includes="*.jar" />
	</path>		

	<!--
	<target name="wait" >
		<waitfor maxwait="10" maxwaitunit="second" timeoutproperty="server.missing">
			<socket port="21" server="218.156.67.18"/>
		</waitfor>
		<fail if="server.missing">서버를 찾을수 없습니다.</fail>
		<echo> =============== 연결 ================ </echo>
	</target> -->
	<!-- <sleep minutes="5" seconds="-15"/> 4분 15초 동안 슬립 -->
	
	
	
	<!--  파일 삭제 이동 등등
	<delete dir="${pc.dir.root}/${workProject.name}/${templit.script}/${myPage.script.name1}"/>
	<delete dir="${pc.dir.root}/${workProject.name}/${templit.script}/${myPage.script.name2}"/>		
	<copy todir="${pc.dir.root}/${workProject.name}/${templit.script}" >
	    <fileset dir="${pc.dir.root}/${myPage.name}/${templit.script}" >
			<include name="${myPage.script.name1}/**/*.js" />
	        <include name="${myPage.script.name2}/**/*.js" />
		</fileset>
	</copy> -->	
	
</project>

